generator client {
  provider = "prisma-client"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model bookings {
  booking_id                        Int       @id @default(autoincrement())
  resource_id                       Int
  user_id                           Int
  start_datetime                    DateTime  @db.DateTime(0)
  end_datetime                      DateTime  @db.DateTime(0)
  status                            String?   @db.VarChar(20)
  approver_id                       Int?
  created_at                        DateTime? @default(now()) @db.DateTime(0)
  resources                         resources @relation(fields: [resource_id], references: [resource_id], onUpdate: Restrict, map: "bookings_ibfk_1")
  users_bookings_user_idTousers     users     @relation("bookings_user_idTousers", fields: [user_id], references: [user_id], onUpdate: Restrict, map: "bookings_ibfk_2")
  users_bookings_approver_idTousers users?    @relation("bookings_approver_idTousers", fields: [approver_id], references: [user_id], onDelete: Restrict, onUpdate: Restrict, map: "bookings_ibfk_3")

  @@index([approver_id], map: "approver_id")
  @@index([resource_id], map: "resource_id")
  @@index([user_id], map: "user_id")
}

model buildings {
  building_id     Int         @id @default(autoincrement())
  building_name   String      @db.VarChar(100)
  building_number String?     @db.VarChar(50)
  total_floors    Int?
  resources       resources[]
}

model cupboards {
  cupboard_id   Int       @id @default(autoincrement())
  resource_id   Int
  cupboard_name String?   @db.VarChar(100)
  total_shelves Int?
  resources     resources @relation(fields: [resource_id], references: [resource_id], onDelete: Cascade, onUpdate: Restrict, map: "cupboards_ibfk_1")
  shelves       shelves[]

  @@index([resource_id], map: "resource_id")
}

model facilities {
  facility_id   Int       @id @default(autoincrement())
  resource_id   Int
  facility_name String    @db.VarChar(100)
  details       String?   @db.Text
  resources     resources @relation(fields: [resource_id], references: [resource_id], onDelete: Cascade, onUpdate: Restrict, map: "facilities_ibfk_1")

  @@index([resource_id], map: "resource_id")
}

model maintenance {
  maintenance_id   Int       @id @default(autoincrement())
  resource_id      Int
  user_id          Int
  maintenance_type String?   @db.VarChar(100)
  scheduled_date   DateTime? @db.Date
  status           String?   @db.VarChar(20)
  notes            String?   @db.Text
  resources        resources @relation(fields: [resource_id], references: [resource_id], onUpdate: Restrict, map: "maintenance_ibfk_1")
  users            users     @relation(fields: [user_id], references: [user_id], onUpdate: Restrict, map: "maintenance_ibfk_2")

  @@index([resource_id], map: "resource_id")
  @@index([user_id], map: "user_id")
}

model resource_types {
  resource_type_id Int         @id @default(autoincrement())
  type_name        String      @db.VarChar(100)
  resources        resources[]
}

model resources {
  resource_id      Int            @id @default(autoincrement())
  resource_name    String         @db.VarChar(100)
  resource_type_id Int
  building_id      Int
  floor_number     Int?
  description      String?        @db.Text
  bookings         bookings[]
  cupboards        cupboards[]
  facilities       facilities[]
  maintenance      maintenance[]
  resource_types   resource_types @relation(fields: [resource_type_id], references: [resource_type_id], onUpdate: Restrict, map: "resources_ibfk_1")
  buildings        buildings      @relation(fields: [building_id], references: [building_id], onUpdate: Restrict, map: "resources_ibfk_2")

  @@index([building_id], map: "building_id")
  @@index([resource_type_id], map: "resource_type_id")
}

model shelves {
  shelf_id     Int       @id @default(autoincrement())
  cupboard_id  Int
  shelf_number Int?
  capacity     Int?
  description  String?   @db.Text
  cupboards    cupboards @relation(fields: [cupboard_id], references: [cupboard_id], onDelete: Cascade, onUpdate: Restrict, map: "shelves_ibfk_1")

  @@index([cupboard_id], map: "cupboard_id")
}

model users {
  user_id                              Int           @id @default(autoincrement())
  name                                 String        @db.VarChar(100)
  email                                String        @unique(map: "email") @db.VarChar(100)
  role                                 String        @db.VarChar(20)
  password                             String        @db.VarChar(255)
  created_at                           DateTime?     @default(now()) @db.DateTime(0)
  bookings_bookings_user_idTousers     bookings[]    @relation("bookings_user_idTousers")
  bookings_bookings_approver_idTousers bookings[]    @relation("bookings_approver_idTousers")
  maintenance                          maintenance[]
}
